---
 - name: AiDiag tool installation and configuration
   hosts: localhost
   connection: local
   gather_facts: no
   tasks:
      - name: Install nodejs
        apt:
          name: nodejs
          state: present
    
      - name: Install npm
        apt:
          name: npm
          state: present
    
      - name: Install AiDiag tool
        file:
          path: /usr/local/bin/aidiag
          state: directory
    
      - name: Copying AiDiag script
        copy: 
          src: aidiag
          dest: /usr/local/bin/aidiag
      
      - name: Copying aidiag.js
        copy: 
          src: aidiag.js
          dest: /usr/local/bin/aidiag/aidiag.js

      - name: Copying npm-dep.js
        copy: 
          src: npm-dep.js
          dest: /usr/local/bin/aidiag/npm-dep.js
      
      - name: Running npm install
        shell: node /usr/local/bin/aidiag/npm-dep.js

      - name: Sourcing bashrc
        shell: source ~/.bashrc